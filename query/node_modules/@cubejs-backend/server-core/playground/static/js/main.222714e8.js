!function(e){function t(t){for(var r,s,o=t[0],c=t[1],u=t[2],p=0,m=[];p<o.length;p++)s=o[p],a[s]&&m.push(a[s][0]),a[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(l&&l(t);m.length;)m.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(r=!1)}r&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var r={},a={1:0},i=[];function s(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=r,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(n,r,function(t){return e[t]}.bind(null,r));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="./";var o=window.webpackJsonp=window.webpackJsonp||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var l=c;i.push([1413,0,2]),n()}({1413:function(e,t,n){e.exports=n(3746)},1994:function(e,t){},2620:function(e,t,n){var r={"./Binary_Property/ASCII.js":2621,"./Binary_Property/ASCII_Hex_Digit.js":2622,"./Binary_Property/Alphabetic.js":2623,"./Binary_Property/Any.js":2624,"./Binary_Property/Assigned.js":2625,"./Binary_Property/Bidi_Control.js":2626,"./Binary_Property/Bidi_Mirrored.js":2627,"./Binary_Property/Case_Ignorable.js":2628,"./Binary_Property/Cased.js":2629,"./Binary_Property/Changes_When_Casefolded.js":2630,"./Binary_Property/Changes_When_Casemapped.js":2631,"./Binary_Property/Changes_When_Lowercased.js":2632,"./Binary_Property/Changes_When_NFKC_Casefolded.js":2633,"./Binary_Property/Changes_When_Titlecased.js":2634,"./Binary_Property/Changes_When_Uppercased.js":2635,"./Binary_Property/Dash.js":2636,"./Binary_Property/Default_Ignorable_Code_Point.js":2637,"./Binary_Property/Deprecated.js":2638,"./Binary_Property/Diacritic.js":2639,"./Binary_Property/Emoji.js":2640,"./Binary_Property/Emoji_Component.js":2641,"./Binary_Property/Emoji_Modifier.js":2642,"./Binary_Property/Emoji_Modifier_Base.js":2643,"./Binary_Property/Emoji_Presentation.js":2644,"./Binary_Property/Extended_Pictographic.js":2645,"./Binary_Property/Extender.js":2646,"./Binary_Property/Grapheme_Base.js":2647,"./Binary_Property/Grapheme_Extend.js":2648,"./Binary_Property/Hex_Digit.js":2649,"./Binary_Property/IDS_Binary_Operator.js":2650,"./Binary_Property/IDS_Trinary_Operator.js":2651,"./Binary_Property/ID_Continue.js":2652,"./Binary_Property/ID_Start.js":2653,"./Binary_Property/Ideographic.js":2654,"./Binary_Property/Join_Control.js":2655,"./Binary_Property/Logical_Order_Exception.js":2656,"./Binary_Property/Lowercase.js":2657,"./Binary_Property/Math.js":2658,"./Binary_Property/Noncharacter_Code_Point.js":2659,"./Binary_Property/Pattern_Syntax.js":2660,"./Binary_Property/Pattern_White_Space.js":2661,"./Binary_Property/Quotation_Mark.js":2662,"./Binary_Property/Radical.js":2663,"./Binary_Property/Regional_Indicator.js":2664,"./Binary_Property/Sentence_Terminal.js":2665,"./Binary_Property/Soft_Dotted.js":2666,"./Binary_Property/Terminal_Punctuation.js":2667,"./Binary_Property/Unified_Ideograph.js":2668,"./Binary_Property/Uppercase.js":2669,"./Binary_Property/Variation_Selector.js":2670,"./Binary_Property/White_Space.js":2671,"./Binary_Property/XID_Continue.js":2672,"./Binary_Property/XID_Start.js":2673,"./General_Category/Cased_Letter.js":2674,"./General_Category/Close_Punctuation.js":2675,"./General_Category/Connector_Punctuation.js":2676,"./General_Category/Control.js":2677,"./General_Category/Currency_Symbol.js":2678,"./General_Category/Dash_Punctuation.js":2679,"./General_Category/Decimal_Number.js":2680,"./General_Category/Enclosing_Mark.js":2681,"./General_Category/Final_Punctuation.js":2682,"./General_Category/Format.js":2683,"./General_Category/Initial_Punctuation.js":2684,"./General_Category/Letter.js":2685,"./General_Category/Letter_Number.js":2686,"./General_Category/Line_Separator.js":2687,"./General_Category/Lowercase_Letter.js":2688,"./General_Category/Mark.js":2689,"./General_Category/Math_Symbol.js":2690,"./General_Category/Modifier_Letter.js":2691,"./General_Category/Modifier_Symbol.js":2692,"./General_Category/Nonspacing_Mark.js":2693,"./General_Category/Number.js":2694,"./General_Category/Open_Punctuation.js":2695,"./General_Category/Other.js":2696,"./General_Category/Other_Letter.js":2697,"./General_Category/Other_Number.js":2698,"./General_Category/Other_Punctuation.js":2699,"./General_Category/Other_Symbol.js":2700,"./General_Category/Paragraph_Separator.js":2701,"./General_Category/Private_Use.js":2702,"./General_Category/Punctuation.js":2703,"./General_Category/Separator.js":2704,"./General_Category/Space_Separator.js":2705,"./General_Category/Spacing_Mark.js":2706,"./General_Category/Surrogate.js":2707,"./General_Category/Symbol.js":2708,"./General_Category/Titlecase_Letter.js":2709,"./General_Category/Unassigned.js":2710,"./General_Category/Uppercase_Letter.js":2711,"./Script/Adlam.js":2712,"./Script/Ahom.js":2713,"./Script/Anatolian_Hieroglyphs.js":2714,"./Script/Arabic.js":2715,"./Script/Armenian.js":2716,"./Script/Avestan.js":2717,"./Script/Balinese.js":2718,"./Script/Bamum.js":2719,"./Script/Bassa_Vah.js":2720,"./Script/Batak.js":2721,"./Script/Bengali.js":2722,"./Script/Bhaiksuki.js":2723,"./Script/Bopomofo.js":2724,"./Script/Brahmi.js":2725,"./Script/Braille.js":2726,"./Script/Buginese.js":2727,"./Script/Buhid.js":2728,"./Script/Canadian_Aboriginal.js":2729,"./Script/Carian.js":2730,"./Script/Caucasian_Albanian.js":2731,"./Script/Chakma.js":2732,"./Script/Cham.js":2733,"./Script/Cherokee.js":2734,"./Script/Common.js":2735,"./Script/Coptic.js":2736,"./Script/Cuneiform.js":2737,"./Script/Cypriot.js":2738,"./Script/Cyrillic.js":2739,"./Script/Deseret.js":2740,"./Script/Devanagari.js":2741,"./Script/Dogra.js":2742,"./Script/Duployan.js":2743,"./Script/Egyptian_Hieroglyphs.js":2744,"./Script/Elbasan.js":2745,"./Script/Ethiopic.js":2746,"./Script/Georgian.js":2747,"./Script/Glagolitic.js":2748,"./Script/Gothic.js":2749,"./Script/Grantha.js":2750,"./Script/Greek.js":2751,"./Script/Gujarati.js":2752,"./Script/Gunjala_Gondi.js":2753,"./Script/Gurmukhi.js":2754,"./Script/Han.js":2755,"./Script/Hangul.js":2756,"./Script/Hanifi_Rohingya.js":2757,"./Script/Hanunoo.js":2758,"./Script/Hatran.js":2759,"./Script/Hebrew.js":2760,"./Script/Hiragana.js":2761,"./Script/Imperial_Aramaic.js":2762,"./Script/Inherited.js":2763,"./Script/Inscriptional_Pahlavi.js":2764,"./Script/Inscriptional_Parthian.js":2765,"./Script/Javanese.js":2766,"./Script/Kaithi.js":2767,"./Script/Kannada.js":2768,"./Script/Katakana.js":2769,"./Script/Kayah_Li.js":2770,"./Script/Kharoshthi.js":2771,"./Script/Khmer.js":2772,"./Script/Khojki.js":2773,"./Script/Khudawadi.js":2774,"./Script/Lao.js":2775,"./Script/Latin.js":2776,"./Script/Lepcha.js":2777,"./Script/Limbu.js":2778,"./Script/Linear_A.js":2779,"./Script/Linear_B.js":2780,"./Script/Lisu.js":2781,"./Script/Lycian.js":2782,"./Script/Lydian.js":2783,"./Script/Mahajani.js":2784,"./Script/Makasar.js":2785,"./Script/Malayalam.js":2786,"./Script/Mandaic.js":2787,"./Script/Manichaean.js":2788,"./Script/Marchen.js":2789,"./Script/Masaram_Gondi.js":2790,"./Script/Medefaidrin.js":2791,"./Script/Meetei_Mayek.js":2792,"./Script/Mende_Kikakui.js":2793,"./Script/Meroitic_Cursive.js":2794,"./Script/Meroitic_Hieroglyphs.js":2795,"./Script/Miao.js":2796,"./Script/Modi.js":2797,"./Script/Mongolian.js":2798,"./Script/Mro.js":2799,"./Script/Multani.js":2800,"./Script/Myanmar.js":2801,"./Script/Nabataean.js":2802,"./Script/New_Tai_Lue.js":2803,"./Script/Newa.js":2804,"./Script/Nko.js":2805,"./Script/Nushu.js":2806,"./Script/Ogham.js":2807,"./Script/Ol_Chiki.js":2808,"./Script/Old_Hungarian.js":2809,"./Script/Old_Italic.js":2810,"./Script/Old_North_Arabian.js":2811,"./Script/Old_Permic.js":2812,"./Script/Old_Persian.js":2813,"./Script/Old_Sogdian.js":2814,"./Script/Old_South_Arabian.js":2815,"./Script/Old_Turkic.js":2816,"./Script/Oriya.js":2817,"./Script/Osage.js":2818,"./Script/Osmanya.js":2819,"./Script/Pahawh_Hmong.js":2820,"./Script/Palmyrene.js":2821,"./Script/Pau_Cin_Hau.js":2822,"./Script/Phags_Pa.js":2823,"./Script/Phoenician.js":2824,"./Script/Psalter_Pahlavi.js":2825,"./Script/Rejang.js":2826,"./Script/Runic.js":2827,"./Script/Samaritan.js":2828,"./Script/Saurashtra.js":2829,"./Script/Sharada.js":2830,"./Script/Shavian.js":2831,"./Script/Siddham.js":2832,"./Script/SignWriting.js":2833,"./Script/Sinhala.js":2834,"./Script/Sogdian.js":2835,"./Script/Sora_Sompeng.js":2836,"./Script/Soyombo.js":2837,"./Script/Sundanese.js":2838,"./Script/Syloti_Nagri.js":2839,"./Script/Syriac.js":2840,"./Script/Tagalog.js":2841,"./Script/Tagbanwa.js":2842,"./Script/Tai_Le.js":2843,"./Script/Tai_Tham.js":2844,"./Script/Tai_Viet.js":2845,"./Script/Takri.js":2846,"./Script/Tamil.js":2847,"./Script/Tangut.js":2848,"./Script/Telugu.js":2849,"./Script/Thaana.js":2850,"./Script/Thai.js":2851,"./Script/Tibetan.js":2852,"./Script/Tifinagh.js":2853,"./Script/Tirhuta.js":2854,"./Script/Ugaritic.js":2855,"./Script/Vai.js":2856,"./Script/Warang_Citi.js":2857,"./Script/Yi.js":2858,"./Script/Zanabazar_Square.js":2859,"./Script_Extensions/Adlam.js":2860,"./Script_Extensions/Ahom.js":2861,"./Script_Extensions/Anatolian_Hieroglyphs.js":2862,"./Script_Extensions/Arabic.js":2863,"./Script_Extensions/Armenian.js":2864,"./Script_Extensions/Avestan.js":2865,"./Script_Extensions/Balinese.js":2866,"./Script_Extensions/Bamum.js":2867,"./Script_Extensions/Bassa_Vah.js":2868,"./Script_Extensions/Batak.js":2869,"./Script_Extensions/Bengali.js":2870,"./Script_Extensions/Bhaiksuki.js":2871,"./Script_Extensions/Bopomofo.js":2872,"./Script_Extensions/Brahmi.js":2873,"./Script_Extensions/Braille.js":2874,"./Script_Extensions/Buginese.js":2875,"./Script_Extensions/Buhid.js":2876,"./Script_Extensions/Canadian_Aboriginal.js":2877,"./Script_Extensions/Carian.js":2878,"./Script_Extensions/Caucasian_Albanian.js":2879,"./Script_Extensions/Chakma.js":2880,"./Script_Extensions/Cham.js":2881,"./Script_Extensions/Cherokee.js":2882,"./Script_Extensions/Common.js":2883,"./Script_Extensions/Coptic.js":2884,"./Script_Extensions/Cuneiform.js":2885,"./Script_Extensions/Cypriot.js":2886,"./Script_Extensions/Cyrillic.js":2887,"./Script_Extensions/Deseret.js":2888,"./Script_Extensions/Devanagari.js":2889,"./Script_Extensions/Dogra.js":2890,"./Script_Extensions/Duployan.js":2891,"./Script_Extensions/Egyptian_Hieroglyphs.js":2892,"./Script_Extensions/Elbasan.js":2893,"./Script_Extensions/Ethiopic.js":2894,"./Script_Extensions/Georgian.js":2895,"./Script_Extensions/Glagolitic.js":2896,"./Script_Extensions/Gothic.js":2897,"./Script_Extensions/Grantha.js":2898,"./Script_Extensions/Greek.js":2899,"./Script_Extensions/Gujarati.js":2900,"./Script_Extensions/Gunjala_Gondi.js":2901,"./Script_Extensions/Gurmukhi.js":2902,"./Script_Extensions/Han.js":2903,"./Script_Extensions/Hangul.js":2904,"./Script_Extensions/Hanifi_Rohingya.js":2905,"./Script_Extensions/Hanunoo.js":2906,"./Script_Extensions/Hatran.js":2907,"./Script_Extensions/Hebrew.js":2908,"./Script_Extensions/Hiragana.js":2909,"./Script_Extensions/Imperial_Aramaic.js":2910,"./Script_Extensions/Inherited.js":2911,"./Script_Extensions/Inscriptional_Pahlavi.js":2912,"./Script_Extensions/Inscriptional_Parthian.js":2913,"./Script_Extensions/Javanese.js":2914,"./Script_Extensions/Kaithi.js":2915,"./Script_Extensions/Kannada.js":2916,"./Script_Extensions/Katakana.js":2917,"./Script_Extensions/Kayah_Li.js":2918,"./Script_Extensions/Kharoshthi.js":2919,"./Script_Extensions/Khmer.js":2920,"./Script_Extensions/Khojki.js":2921,"./Script_Extensions/Khudawadi.js":2922,"./Script_Extensions/Lao.js":2923,"./Script_Extensions/Latin.js":2924,"./Script_Extensions/Lepcha.js":2925,"./Script_Extensions/Limbu.js":2926,"./Script_Extensions/Linear_A.js":2927,"./Script_Extensions/Linear_B.js":2928,"./Script_Extensions/Lisu.js":2929,"./Script_Extensions/Lycian.js":2930,"./Script_Extensions/Lydian.js":2931,"./Script_Extensions/Mahajani.js":2932,"./Script_Extensions/Makasar.js":2933,"./Script_Extensions/Malayalam.js":2934,"./Script_Extensions/Mandaic.js":2935,"./Script_Extensions/Manichaean.js":2936,"./Script_Extensions/Marchen.js":2937,"./Script_Extensions/Masaram_Gondi.js":2938,"./Script_Extensions/Medefaidrin.js":2939,"./Script_Extensions/Meetei_Mayek.js":2940,"./Script_Extensions/Mende_Kikakui.js":2941,"./Script_Extensions/Meroitic_Cursive.js":2942,"./Script_Extensions/Meroitic_Hieroglyphs.js":2943,"./Script_Extensions/Miao.js":2944,"./Script_Extensions/Modi.js":2945,"./Script_Extensions/Mongolian.js":2946,"./Script_Extensions/Mro.js":2947,"./Script_Extensions/Multani.js":2948,"./Script_Extensions/Myanmar.js":2949,"./Script_Extensions/Nabataean.js":2950,"./Script_Extensions/New_Tai_Lue.js":2951,"./Script_Extensions/Newa.js":2952,"./Script_Extensions/Nko.js":2953,"./Script_Extensions/Nushu.js":2954,"./Script_Extensions/Ogham.js":2955,"./Script_Extensions/Ol_Chiki.js":2956,"./Script_Extensions/Old_Hungarian.js":2957,"./Script_Extensions/Old_Italic.js":2958,"./Script_Extensions/Old_North_Arabian.js":2959,"./Script_Extensions/Old_Permic.js":2960,"./Script_Extensions/Old_Persian.js":2961,"./Script_Extensions/Old_Sogdian.js":2962,"./Script_Extensions/Old_South_Arabian.js":2963,"./Script_Extensions/Old_Turkic.js":2964,"./Script_Extensions/Oriya.js":2965,"./Script_Extensions/Osage.js":2966,"./Script_Extensions/Osmanya.js":2967,"./Script_Extensions/Pahawh_Hmong.js":2968,"./Script_Extensions/Palmyrene.js":2969,"./Script_Extensions/Pau_Cin_Hau.js":2970,"./Script_Extensions/Phags_Pa.js":2971,"./Script_Extensions/Phoenician.js":2972,"./Script_Extensions/Psalter_Pahlavi.js":2973,"./Script_Extensions/Rejang.js":2974,"./Script_Extensions/Runic.js":2975,"./Script_Extensions/Samaritan.js":2976,"./Script_Extensions/Saurashtra.js":2977,"./Script_Extensions/Sharada.js":2978,"./Script_Extensions/Shavian.js":2979,"./Script_Extensions/Siddham.js":2980,"./Script_Extensions/SignWriting.js":2981,"./Script_Extensions/Sinhala.js":2982,"./Script_Extensions/Sogdian.js":2983,"./Script_Extensions/Sora_Sompeng.js":2984,"./Script_Extensions/Soyombo.js":2985,"./Script_Extensions/Sundanese.js":2986,"./Script_Extensions/Syloti_Nagri.js":2987,"./Script_Extensions/Syriac.js":2988,"./Script_Extensions/Tagalog.js":2989,"./Script_Extensions/Tagbanwa.js":2990,"./Script_Extensions/Tai_Le.js":2991,"./Script_Extensions/Tai_Tham.js":2992,"./Script_Extensions/Tai_Viet.js":2993,"./Script_Extensions/Takri.js":2994,"./Script_Extensions/Tamil.js":2995,"./Script_Extensions/Tangut.js":2996,"./Script_Extensions/Telugu.js":2997,"./Script_Extensions/Thaana.js":2998,"./Script_Extensions/Thai.js":2999,"./Script_Extensions/Tibetan.js":3e3,"./Script_Extensions/Tifinagh.js":3001,"./Script_Extensions/Tirhuta.js":3002,"./Script_Extensions/Ugaritic.js":3003,"./Script_Extensions/Vai.js":3004,"./Script_Extensions/Warang_Citi.js":3005,"./Script_Extensions/Yi.js":3006,"./Script_Extensions/Zanabazar_Square.js":3007,"./index.js":3008,"./unicode-version.js":3009};function a(e){var t=i(e);return n(t)}function i(e){var t=r[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}a.keys=function(){return Object.keys(r)},a.resolve=i,e.exports=a,a.id=2620},321:function(e,t,n){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var a=r(n(1444));n(761);var i=r(n(1446));n(1447);var s=r(n(1452)),o=r(n(1453));n(1454);var c=r(n(1464));n(1465),n(1470);var u=r(n(1472));n(1473),n(779),n(1477);var l=r(n(1479)),p=r(n(778));n(1483),n(1485),n(1486),n(1489);var m=r(n(1490));n(1492),n(1493),n(1495);var d=n(3745),h=r(n(784)),y=r(n(1496));n(1497),n(1498),n(1505);var f=y.extendMoment(h),j={day:function(e){return Array.from(e.by("day")).map(function(e){return e.format("YYYY-MM-DDT00:00:00.000")})},month:function(e){return Array.from(e.snapTo("month").by("month")).map(function(e){return e.format("YYYY-MM-01T00:00:00.000")})},year:function(e){return Array.from(e.snapTo("year").by("year")).map(function(e){return e.format("YYYY-01-01T00:00:00.000")})},hour:function(e){return Array.from(e.by("hour")).map(function(e){return e.format("YYYY-MM-DDTHH:00:00.000")})},week:function(e){return Array.from(e.snapTo("isoweek").by("week")).map(function(e){return e.startOf("isoweek").format("YYYY-MM-DDT00:00:00.000")})}},S=function(){function e(t){s(this,e),this.loadResponse=t}return o(e,[{key:"series",value:function(e){var t=this;return this.seriesNames(e).map(function(n){var r=n.title,a=n.key;return{title:r,series:t.chartPivot(e).map(function(e){var t=e.category,n=e.x;return{value:m(e,["category","x"])[a],category:t,x:n}})}})}},{key:"axisValues",value:function(e){var t=this.loadResponse.query;return function(n){var r=function(t){return e.filter(function(e){return"measures"!==e}).map(function(e){return null!=n[e]?n[e]:null}).concat(t?[t]:[])};return e.find(function(e){return"measures"===e})&&(t.measures||[]).length?t.measures.map(r):[r()]}}},{key:"axisValuesString",value:function(e,t){return e.map(function(e){return null==e?"âˆ…":""===e?"[Empty string]":e}).join(t||", ")}},{key:"normalizePivotConfig",value:function(e){var t=this.loadResponse.query,n=(t.timeDimensions||[]).filter(function(e){return!!e.granularity});(e=e||(n.length?{x:n.map(function(e){return e.dimension}),y:t.dimensions||[]}:{x:t.dimensions||[],y:[]})).x=e.x||[],e.y=e.y||[];var r=e.x.concat(e.y),a=n.map(function(e){return e.dimension}).concat(t.dimensions);return e.x=e.x.concat(a.filter(function(e){return-1===r.indexOf(e)})),e.x.concat(e.y).find(function(e){return"measures"===e})||(e.y=e.y.concat(["measures"])),null==e.fillMissingDates&&(e.fillMissingDates=!0),e}},{key:"timeSeries",value:function(e){if(!e.granularity)return null;var t=e.dateRange;if(!t){var n=d.pipe(d.map(function(t){return t[e.dimension]&&f(t[e.dimension])}),d.filter(function(e){return!!e}))(this.loadResponse.data);t=n.length&&[d.reduce(d.minBy(function(e){return e.toDate()}),n[0],n),d.reduce(d.maxBy(function(e){return e.toDate()}),n[0],n)]||null}if(!t)return null;var r=f(t[0]).format("YYYY-MM-DD 00:00:00"),a=f(t[1]).format("YYYY-MM-DD 23:59:59"),i=f.range(r,a);if(!j[e.granularity])throw new Error("Unsupported time granularity: ".concat(e.granularity));return j[e.granularity](i)}},{key:"pivot",value:function(t){var n=this;t=this.normalizePivotConfig(t);var r=d.groupBy(function(e){var t=e.xValues;return n.axisValuesString(t)}),a=function(e,t,n){return e[t]};if(t.fillMissingDates&&1===t.x.length&&d.equals(t.x,(this.loadResponse.query.timeDimensions||[]).filter(function(e){return!!e.granularity}).map(function(e){return e.dimension}))){var i=this.timeSeries(this.loadResponse.query.timeDimensions[0]);i&&(r=function(e){var t=d.groupBy(function(e){var t=e.xValues;return f(t[0]).format(f.HTML5_FMT.DATETIME_LOCAL_MS)},e);return i.map(function(e){return p({},e,t[e]||[{xValues:[e],row:{}}])}).reduce(function(e,t){return Object.assign(e,t)},{})},a=function(e,t,n){return e[t]||0})}var s=d.pipe(d.map(function(e){return n.axisValues(t.x)(e).map(function(t){return{xValues:t,row:e}})}),d.unnest,r,d.toPairs)(this.loadResponse.data),o=d.pipe(d.map(function(e){var r=l(e,2),a=(r[0],r[1]);return d.unnest(a.filter(function(e){var t=e.row;return Object.keys(t).length>0}).map(function(e){var r=e.row;return n.axisValues(t.y)(r)}))}),d.unnest,d.uniq)(s);return s.map(function(r){var i=l(r,2),s=(i[0],i[1]),c=s[0].xValues,u=d.pipe(d.map(function(e){var r=e.row;return n.axisValues(t.y)(r).map(function(e){return{yValues:e,row:r}})}),d.unnest,d.groupBy(function(e){var t=e.yValues;return n.axisValuesString(t)}))(s);return{xValues:c,yValuesArray:d.unnest(o.map(function(r){var i=t.x.find(function(e){return"measures"===e})?e.measureFromAxis(c):e.measureFromAxis(r);return(u[n.axisValuesString(r)]||[{row:{}}]).map(function(e){var t=e.row;return[r,a(t,i,c)]})}))}})}},{key:"pivotedRows",value:function(e){return this.chartPivot(e)}},{key:"chartPivot",value:function(e){var t=this;return this.pivot(e).map(function(e){var n=e.xValues,r=e.yValuesArray;return u({category:t.axisValuesString(n,", "),x:t.axisValuesString(n,", ")},r.map(function(e){var n=l(e,2),r=n[0],a=n[1];return p({},t.axisValuesString(r,", "),a&&Number.parseFloat(a))}).reduce(function(e,t){return Object.assign(e,t)},{}))})}},{key:"tablePivot",value:function(e){var t=this.normalizePivotConfig(e),n=function(e,t){return function(n,r){return p({},"measures"===n?e[r]:n,"measures"===n?t:e[r])}};return this.pivot(t).map(function(e){var r=e.xValues;return e.yValuesArray.map(function(e){var a=l(e,2),i=a[0],s=a[1];return t.x.map(n(r,s)).concat(t.y.map(n(i,s))).reduce(function(e,t){return Object.assign(e,t)},{})}).reduce(function(e,t){return Object.assign(e,t)},{})})}},{key:"tableColumns",value:function(e){var t=this,n=this.normalizePivotConfig(e),r=function(e){return"measures"===e?(t.query().measures||[]).map(function(e){return{key:e,title:t.loadResponse.annotation.measures[e].title}}):[{key:e,title:(t.loadResponse.annotation.dimensions[e]||t.loadResponse.annotation.timeDimensions[e]).title}]};return n.x.map(r).concat(n.y.map(r)).reduce(function(e,t){return e.concat(t)})}},{key:"totalRow",value:function(){return this.chartPivot()[0]}},{key:"categories",value:function(e){return this.chartPivot(e)}},{key:"seriesNames",value:function(t){var n=this;return t=this.normalizePivotConfig(t),d.pipe(d.map(this.axisValues(t.y)),d.unnest,d.uniq)(this.loadResponse.data).map(function(r){return{title:n.axisValuesString(t.y.find(function(e){return"measures"===e})?d.dropLast(1,r).concat(n.loadResponse.annotation.measures[e.measureFromAxis(r)].title):r,", "),key:n.axisValuesString(r)}})}},{key:"query",value:function(){return this.loadResponse.query}},{key:"rawData",value:function(){return this.loadResponse.data}}],[{key:"measureFromAxis",value:function(e){return e[e.length-1]}}]),e}(),g=function(){function e(t){s(this,e),this.sqlQuery=t}return o(e,[{key:"rawQuery",value:function(){return this.sqlQuery.sql}},{key:"sql",value:function(){return this.rawQuery().sql[0]}}]),e}(),b=function(e){return d.fromPairs(e.map(function(e){return[e.name,e]}))},v={string:[{name:"contains",title:"contains"},{name:"notContains",title:"does not contain"},{name:"equals",title:"equals"},{name:"notEquals",title:"does not equal"},{name:"set",title:"is set"},{name:"notSet",title:"is not set"}],number:[{name:"equals",title:"equals"},{name:"notEquals",title:"does not equal"},{name:"set",title:"is set"},{name:"notSet",title:"is not set"},{name:"gt",title:">"},{name:"gte",title:">="},{name:"lt",title:"<"},{name:"lte",title:"<="}]},_=function(){function e(t){s(this,e),this.meta=t;var n=this.meta.cubes;this.cubes=n,this.cubesMap=d.fromPairs(n.map(function(e){return[e.name,{measures:b(e.measures),dimensions:b(e.dimensions),segments:b(e.segments)}]}))}return o(e,[{key:"membersForQuery",value:function(e,t){return d.unnest(this.cubes.map(function(e){return e[t]}))}},{key:"resolveMember",value:function(e,t){var n=this,r=e.split("."),a=l(r,1)[0];if(!this.cubesMap[a])return{title:e,error:"Cube not found ".concat(a," for path '").concat(e,"'")};var i=(Array.isArray(t)?t:[t]).map(function(t){return n.cubesMap[a][t]&&n.cubesMap[a][t][e]}).find(function(e){return e});return i||{title:e,error:"Path not found '".concat(e,"'")}}},{key:"defaultTimeDimensionNameFor",value:function(e){var t=this,n=e.split("."),r=l(n,1)[0];return this.cubesMap[r]?Object.keys(this.cubesMap[r].dimensions||{}).find(function(e){return"time"===t.cubesMap[r].dimensions[e].type}):null}},{key:"filterOperatorsForMember",value:function(e,t){var n=this.resolveMember(e,t);return v[n.type]||v.string}}]),e}(),x=function(){function e(t){s(this,e),this.progressResponse=t}return o(e,[{key:"stage",value:function(){return this.progressResponse.stage}},{key:"timeElapsed",value:function(){return this.progressResponse.timeElapsed}}]),e}(),E="https://statsbot.co/cubejs-api/v1",k=0,C=function(e){return new Promise(function(t,n){e.then(function(e){return t(e)},function(e){return"Mutex has been changed"!==e&&n(e)})})},O=function(){function e(t,n){s(this,e),n=n||{},this.apiToken=t,this.apiUrl=n.apiUrl||E}return o(e,[{key:"request",value:function(e,t){return c("".concat(this.apiUrl).concat(e),Object.assign({headers:{Authorization:this.apiToken,"Content-Type":"application/json"}},t||{}))}},{key:"loadMethod",value:function(e,t,n,r){var s=++k;"function"!=typeof n||r||(r=n,n=void 0);var o=(n=n||{}).mutexKey||"default";n.mutexObj&&(n.mutexObj[o]=s);var c=function(){if(n.mutexObj&&n.mutexObj[o]!==s)throw"Mutex has been changed"},u=function(){var r=i(a.mark(function r(){var i,s;return a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e();case 2:if(502!==(i=r.sent).status){r.next=6;break}return c(),r.abrupt("return",u());case 6:return r.next=8,i.json();case 8:if("Continue wait"!==(s=r.sent).error){r.next=13;break}return c(),n.progressCallback&&n.progressCallback(new x(s)),r.abrupt("return",u());case 13:if(200===i.status){r.next=16;break}throw c(),new Error(s.error);case 16:return c(),r.abrupt("return",t(s));case 18:case"end":return r.stop()}},r,this)}));return function(){return r.apply(this,arguments)}}();if(!r)return C(u());C(u()).then(function(e){return r(null,e)},function(e){return r(e)})}},{key:"load",value:function(e,t,n){var r=this;return this.loadMethod(function(){return r.request("/load?query=".concat(encodeURIComponent(JSON.stringify(e))))},function(e){return new S(e)},t,n)}},{key:"sql",value:function(e,t,n){var r=this;return this.loadMethod(function(){return r.request("/sql?query=".concat(JSON.stringify(e)))},function(e){return new g(e)},t,n)}},{key:"meta",value:function(e,t){var n=this;return this.loadMethod(function(){return n.request("/meta")},function(e){return new _(e)},e,t)}}]),e}();e.exports=function(e,t){return new O(e,t)}},322:function(e,t,n){"use strict";function r(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(t,"__esModule",{value:!0}),n(1866);var a=r(n(1873));n(1877),n(1892),n(920),n(1902);var i=r(n(1904)),s=r(n(1905)),o=r(n(1906)),c=r(n(1909)),u=r(n(1910)),l=r(n(1912)),p=n(1915),m=n(3744),d=r(n(1918)),h=r(n(1919)),y=r(n(1920));n(1922);var f=r(n(924));n(1923);var j=r(n(1924));n(925);var S=r(n(1926)),g=function(e){function t(e){var n;return i(this,t),(n=o(this,c(t).call(this,e))).state={},n.mutexObj={},n}return u(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.query,n=e.queries;t&&this.load(t),n&&this.loadQueries(n)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.query,r=t.queries;m.equals(e.query,n)||this.load(n),m.equals(e.queries,r)||this.loadQueries(r)}},{key:"isQueryPresent",value:function(e){return e.measures&&e.measures.length||e.dimensions&&e.dimensions.length||e.timeDimensions&&e.timeDimensions.length}},{key:"load",value:function(e){var t=this;this.setState({isLoading:!0,resultSet:null,error:null,sqlQuery:null});var n=this.props,r=n.loadSql,i=n.cubejsApi;e&&this.isQueryPresent(e)&&("only"===r?i.sql(e,{mutexObj:this.mutexObj,mutexKey:"sql"}).then(function(e){return t.setState({sqlQuery:e,error:null,isLoading:!1})}).catch(function(e){return t.setState({resultSet:null,error:e,isLoading:!1})}):r?Promise.all([i.sql(e,{mutexObj:this.mutexObj,mutexKey:"sql"}),i.load(e,{mutexObj:this.mutexObj,mutexKey:"query"})]).then(function(e){var n=a(e,2),r=n[0],i=n[1];return t.setState({sqlQuery:r,resultSet:i,error:null,isLoading:!1})}).catch(function(e){return t.setState({resultSet:null,error:e,isLoading:!1})}):i.load(e,{mutexObj:this.mutexObj,mutexKey:"query"}).then(function(e){return t.setState({resultSet:e,error:null,isLoading:!1})}).catch(function(e){return t.setState({resultSet:null,error:e,isLoading:!1})}))}},{key:"loadQueries",value:function(e){var t=this;this.setState({isLoading:!0,resultSet:null,error:null}),Promise.all(m.toPairs(e).map(function(e){var n=a(e,2),r=n[0],i=n[1];return t.props.cubejsApi.load(i,{mutexObj:t.mutexObj,mutexKey:r}).then(function(e){return[r,e]})})).then(function(e){return t.setState({resultSet:m.fromPairs(e),error:null,isLoading:!1})}).catch(function(e){return t.setState({resultSet:null,error:e,isLoading:!1})})}},{key:"render",value:function(){var e={error:this.state.error,resultSet:this.props.queries?this.state.resultSet||{}:this.state.resultSet,loadingState:{isLoading:this.state.isLoading},sqlQuery:this.state.sqlQuery};return this.props.render?this.props.render(e):null}}]),t}(l.Component);g.propTypes={render:p.func,afterRender:p.func,cubejsApi:p.object.isRequired,query:p.object,queries:p.object,loadSql:p.any},g.defaultProps={query:{}};var b=function(e){function t(e){var n;return i(this,t),(n=o(this,c(t).call(this,e))).state={query:e.query,chartType:"line"},n}var n;return u(t,e),s(t,[{key:"componentDidMount",value:(n=S(j.mark(function e(){var t,n;return j.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.cubejsApi,e.next=3,t.meta();case 3:n=e.sent,this.setState({meta:n});case 5:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"isQueryPresent",value:function(){var e=this.state.query;return e.measures&&e.measures.length||e.dimensions&&e.dimensions.length||e.timeDimensions&&e.timeDimensions.length}},{key:"prepareRenderProps",value:function(e){var t=this,n=function(e){return e.name},r=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n;return{add:function(n){var a=t.state.query;t.setState(t.applyStateChangeHeuristics({query:h({},a,f({},e,(a[e]||[]).concat(r(n))))}))},remove:function(n){var r=t.state.query,a=(r[e]||[]).concat([]);return a.splice(n.index,1),t.setState(t.applyStateChangeHeuristics({query:h({},r,f({},e,a))}))},update:function(n,a){var i=t.state.query,s=(i[e]||[]).concat([]);return s.splice(n.index,1,r(a)),t.setState(t.applyStateChangeHeuristics({query:h({},i,f({},e,s))}))}}},a=[{name:void 0,title:"w/o grouping"},{name:"hour",title:"Hour"},{name:"day",title:"Day"},{name:"week",title:"Week"},{name:"month",title:"Month"},{name:"year",title:"Year"}],i=this.state,s=i.meta,o=i.query,c=i.chartType;return h({meta:s,query:o,validatedQuery:this.validatedQuery(),isQueryPresent:this.isQueryPresent(),chartType:c,measures:(s&&o.measures||[]).map(function(e,t){return h({index:t},s.resolveMember(e,"measures"))}),dimensions:(s&&o.dimensions||[]).map(function(e,t){return h({index:t},s.resolveMember(e,"dimensions"))}),segments:(s&&o.segments||[]).map(function(e,t){return h({index:t},s.resolveMember(e,"segments"))}),timeDimensions:(s&&o.timeDimensions||[]).map(function(e,t){return h({},e,{dimension:h({},s.resolveMember(e.dimension,"dimensions"),{granularities:a}),index:t})}),filters:(s&&o.filters||[]).map(function(e,t){return h({},e,{dimension:s.resolveMember(e.dimension,["dimensions","measures"]),operators:s.filterOperatorsForMember(e.dimension,["dimensions","measures"]),index:t})}),availableMeasures:s&&s.membersForQuery(o,"measures")||[],availableDimensions:s&&s.membersForQuery(o,"dimensions")||[],availableTimeDimensions:(s&&s.membersForQuery(o,"dimensions")||[]).filter(function(e){return"time"===e.type}),availableSegments:s&&s.membersForQuery(o,"segments")||[],updateMeasures:r("measures"),updateDimensions:r("dimensions"),updateSegments:r("segments"),updateTimeDimensions:r("timeDimensions",function(e){return{dimension:e.dimension.name,granularity:e.granularity,dateRange:e.dateRange}}),updateFilters:r("filters",function(e){return{dimension:e.dimension.name,operator:e.operator,values:e.values}}),updateChartType:function(e){return t.setState(t.applyStateChangeHeuristics({chartType:e}))}},e)}},{key:"validatedQuery",value:function(){var e=this.state.query;return h({},e,{filters:(e.filters||[]).filter(function(e){return e.operator})})}},{key:"defaultHeuristics",value:function(e){var t=this.state,n=t.query,r=t.sessionGranularity||"day";if(e.query){var i=n,s=e.query,o=this.state.meta;if(1===(i.timeDimensions||[]).length&&1===(s.timeDimensions||[]).length&&s.timeDimensions[0].granularity&&i.timeDimensions[0].granularity!==s.timeDimensions[0].granularity&&(e=h({},e,{sessionGranularity:s.timeDimensions[0].granularity})),0===(i.measures||[]).length&&(s.measures||[]).length>0||1===(i.measures||[]).length&&1===(s.measures||[]).length&&i.measures[0]!==s.measures[0]){var c=o.defaultTimeDimensionNameFor(s.measures[0]);return s=h({},s,{timeDimensions:c?[{dimension:c,granularity:r}]:[]}),h({},e,{query:s,chartType:c?"line":"number"})}return 0===(i.dimensions||[]).length&&(s.dimensions||[]).length>0?(s=h({},s,{timeDimensions:(s.timeDimensions||[]).map(function(e){return h({},e,{granularity:void 0})})}),h({},e,{query:s,chartType:"table"})):(i.dimensions||[]).length>0&&0===(s.dimensions||[]).length?(s=h({},s,{timeDimensions:(s.timeDimensions||[]).map(function(e){return h({},e,{granularity:e.granularity||r})})}),h({},e,{query:s,chartType:(s.timeDimensions||[]).length?"line":"number"})):((i.dimensions||[]).length>0||(i.measures||[]).length>0)&&0===(s.dimensions||[]).length&&0===(s.measures||[]).length?(s=h({},s,{timeDimensions:[],filters:[]}),h({},e,{query:s,sessionGranularity:null})):e}if(e.chartType){var u=e.chartType;if(("line"===u||"area"===u)&&1===(n.timeDimensions||[]).length&&!n.timeDimensions[0].granularity){var l=a(n.timeDimensions,1)[0];return h({},e,{query:h({},n,{timeDimensions:[h({},l,{granularity:r})]})})}if(("pie"===u||"table"===u||"number"===u)&&1===(n.timeDimensions||[]).length&&n.timeDimensions[0].granularity){var p=a(n.timeDimensions,1)[0];return h({},e,{query:h({},n,{timeDimensions:[h({},p,{granularity:void 0})]})})}}return e}},{key:"applyStateChangeHeuristics",value:function(e){var t=this.props,n=t.stateChangeHeuristics;return t.disableHeuristics?e:n&&n(this.state,e)||this.defaultHeuristics(e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.cubejsApi,r=t.render;return l.createElement(g,{query:this.validatedQuery(),cubejsApi:n,render:function(t){return r?r(e.prepareRenderProps(t)):null}})}}]),t}(l.Component);b.propTypes={render:p.func,stateChangeHeuristics:p.func,cubejsApi:p.object.isRequired,disableHeuristics:p.bool,query:p.object},b.defaultProps={query:{},stateChangeHeuristics:null,disableHeuristics:!1,render:null},t.QueryRenderer=g,t.QueryRendererWithTotals=function(e){var t=e.query,n=y(e,["query"]);return l.createElement(g,d({queries:{totals:h({},t,{dimensions:[],timeDimensions:t.timeDimensions?t.timeDimensions.map(function(e){return h({},e,{granularity:null})}):void 0}),main:t}},n))},t.QueryBuilder=b},3511:function(e,t,n){},3740:function(e,t,n){},3746:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"sourceCodeTemplate",function(){return _e}),n.d(r,"imports",function(){return xe});var a={};n.r(a),n.d(a,"sourceCodeTemplate",function(){return Ce}),n.d(a,"imports",function(){return Oe});var i={};n.r(i),n.d(i,"sourceCodeTemplate",function(){return we}),n.d(i,"imports",function(){return De});var s=n(1),o=n.n(s),c=n(10),u=n.n(c),l=n(193),p=n(112),m=n(27),d=n.n(m),h=n(50),y=n(90),f=n(91),j=n(102),S=n(101),g=n(103),b=n(183),v=n(315),_=function(e){function t(e){var n;return Object(y.a)(this,t),(n=Object(j.a)(this,Object(S.a)(t).call(this,e))).state={},n}return Object(g.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=Object(h.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadFiles();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadFiles",value:function(){var e=Object(h.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.a)("/playground/files");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,this.setState({files:n.files});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.files?o.a.createElement(l.a,{to:!this.state.files.length||1===this.state.files.length&&"Orders.js"===this.state.files[0].fileName?"/schema":"/explore"}):o.a.createElement("div",{style:{textAlign:"center",padding:24}},o.a.createElement(v.a,null))}}]),t}(s.Component),x=n(321),E=n.n(x),k=n(1408),C=n(494),O=n(60),P=n(495),w=n(110),D=n.n(w),M=n(741),A=n.n(M),T=n(43),L=n(1410),q=function e(t,n){var r=n||{},a=r.retries,i=Object(L.a)(r,["retries"]);return a=a||0,Object(b.a)(t,i).then((s=Object(h.a)(d.a.mark(function e(t){var n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(500!==t.status){e.next=6;break}return e.next=3,t.text();case 3:n=e.sent;try{r=JSON.parse(n),n=r.error}catch(e){}throw n;case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})).catch(function(r){if("Network request failed"===r.message&&a>0)return e(t,{options:n,retries:a-1});throw r});var s},B=n(1862),R=[n(1863)],I=function(e,t,n){return q(e,Object(O.a)({},t,{retries:n}))},N=function(){function e(){Object(y.a)(this,e)}return Object(f.a)(e,[{key:"load",value:function(){var e=Object(h.a)(d.a.mark(function e(t){var n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return e.next=3,I("/playground/ensure-dashboard-app",void 0,5);case 3:return e.next=5,I("/playground/dashboard-app-files",void 0,5);case 5:return n=e.sent,e.next=8,n.json();case 8:(r=e.sent).error?this.loadError=r.error:(this.sourceFiles=r.fileContents,this.parse(r.fileContents));case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"persist",value:function(){var e=Object(h.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.appLayoutAdded?[Object(O.a)({},this.indexCssFile,{content:this.indexCssFile.content+"\nbody {\n  background-color: #f0f2f5 !important;\n}\n"})]:[],e.next=3,I("/playground/dashboard-app-files",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({files:[Object(O.a)({},this.appFile,{content:B.format(this.dashboardAppCode(),{parser:"babylon",plugins:R})})].concat(t)})},5);case 3:return this.appLayoutAdded=!1,n=this.imports.filter(function(e){return 0!==e.get("source").node.value.indexOf(".")}).map(function(e){var t=e.get("source").node.value.split("/"),n=0===t[0].indexOf("@")?[t[0],t[1]].join("/"):t[0];return Object(C.a)({},n,"latest")}).reduce(function(e,t){return Object(O.a)({},e,t)}),e.next=7,I("/playground/ensure-dependencies",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dependencies:n})},5);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"parse",value:function(e){if(this.appFile=e.find(function(e){return-1!==e.fileName.indexOf("src/App.js")}),!this.appFile)throw new Error("src/App.js file not found. Can't parse dashboard app. Please delete dashboard-app directory and try to create it again.");this.indexCssFile=e.find(function(e){return-1!==e.fileName.indexOf("src/index.css")}),this.appAst=Object(P.parse)(this.appFile.content,{sourceFilename:this.appFile.fileName,sourceType:"module",plugins:["jsx"]}),this.findAllImports(),this.findAllDefinitions(),this.findAppClass()}},{key:"findAllImports",value:function(){var e=this;this.imports=[],D()(this.appAst,{ImportDeclaration:function(t){e.imports.push(t)}})}},{key:"findAllDefinitions",value:function(){var e=this;this.definitions=[],D()(this.appAst,{VariableDeclaration:function(t){var n;"Program"===t.parent.type&&(n=e.definitions).push.apply(n,Object(k.a)(t.get("declarations")))}})}},{key:"findAppClass",value:function(){var e=this;if(D()(this.appAst,{Class:function(t){"App"===t.get("id").node.name&&(e.appClass=t)}}),this.appClass||D()(this.appAst,{FunctionDeclaration:function(t){"App"===t.get("id").node.name&&(e.appClass=t)}}),!this.appClass)throw new Error("App class not found. Can't parse dashboard app.  Please delete dashboard-app directory and try to create it again.")}},{key:"ensureDashboardIsInApp",value:function(){var e=this,t=!1,n=null;D()(this.appAst,{JSXOpeningElement:function(e){"Dashboard"===e.get("name").get("name").node&&(t=!0),"header"===e.get("name").get("name").node&&e.get("attributes").find(function(e){return"className"===e.get("name").get("name").node&&e.get("value").node&&"StringLiteral"===e.get("value").node.type&&"App-header"===e.get("value").node.value})&&(n=e)}}),!t&&n&&(this.appLayoutAdded=!0,n.parentPath.replaceWith(T.JSXElement(T.JSXOpeningElement(T.JSXIdentifier("AppLayout"),[]),T.JSXClosingElement(T.JSXIdentifier("AppLayout")),[T.JSXElement(T.JSXOpeningElement(T.JSXIdentifier("Dashboard"),[]),T.JSXClosingElement(T.JSXIdentifier("Dashboard")),[])]))),D()(this.appAst,{JSXOpeningElement:function(t){"Dashboard"===t.get("name").get("name").node&&(e.dashboardElement=t)}})}},{key:"mergeImport",value:function(e){var t=this.imports.find(function(t){return t.get("source").node.value===e.get("source").node.value&&(t.get("specifiers")[0]&&t.get("specifiers")[0].type)===(e.get("specifiers")[0]&&e.get("specifiers")[0].type)});t?e.get("specifiers").forEach(function(e){t.get("specifiers").find(function(t){return(t.get("imported").node&&t.get("imported").node.name)===(e.get("imported").node&&e.get("imported").node.name)&&(t.get("local").node&&t.get("local").node.name)===(e.get("local").node&&e.get("local").node.name)})||t.pushContainer("specifiers",e.node)}):(this.imports[this.imports.length-1].insertAfter(e.node),this.findAllImports())}},{key:"mergeDefinition",value:function(e){var t=this;e.get("declarations").forEach(function(e){t.definitions.find(function(t){return"Identifier"===t.get("id").node.type&&"Identifier"===e.get("id").node.type&&e.get("id").node.name===t.get("id").node.name})||t.appClass.insertBefore(T.variableDeclaration("const",[e.node]))})}},{key:"addChart",value:function(){var e=Object(h.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load(!0);case 2:if(!this.loadError){e.next=4;break}return e.abrupt("return");case 4:return this.ensureDashboardIsInApp(),this.performAddition("\nimport { Row, Col, Card, Layout } from 'antd';\nimport 'antd/dist/antd.css';\nimport './index.css'\n\nconst AppLayout = ({ children }) => (\n  <Layout>\n    <Layout.Header>\n      <div style={{ float: 'left' }}>\n        <h2\n          style={{\n            color: \"#fff\",\n            margin: 0,\n            marginRight: '1em'\n          }}\n        >\n          My Dashboard\n        </h2>\n      </div>\n    </Layout.Header>\n    <Layout.Content\n      style={{\n        padding: \"0 25px 25px 25px\",\n        margin: \"25px\"\n      }}\n    >\n      {children}\n    </Layout.Content>\n  </Layout>\n)\n\nconst Dashboard = ({ children }) => (\n  <Row type=\"flex\" justify=\"space-around\" align=\"top\" gutter={24}>{children}</Row>\n)\n\nconst DashboardItem = ({ children, title }) => (\n  <Col span={24} lg={12}>\n    <Card title={title} style={{ marginBottom: '24px' }}>\n      {children}\n    </Card>\n  </Col>\n)\n"),this.performAddition(t),e.next=9,this.persist();case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"performAddition",value:function(e){var t=this,n=Object(P.parse)(e,{sourceType:"module",plugins:["jsx"]}),r=[];D()(n,{ImportDeclaration:function(e){r.push(e)}});var a=[];D()(n,{VariableDeclaration:function(e){if("Program"===e.parent.type)if("ChartRenderer"===e.get("declarations")[0].get("id").get("name").node){var n=e.get("declarations")[0].get("init").get("body");t.dashboardElement.parentPath.pushContainer("children",T.JSXElement(T.JSXOpeningElement(T.JSXIdentifier("DashboardItem"),[]),T.JSXClosingElement(T.JSXIdentifier("DashboardItem")),[n.node]))}else a.push(e)}}),r.forEach(function(e){return t.mergeImport(e)}),a.forEach(function(e){return t.mergeDefinition(e)})}},{key:"dashboardAppCode",value:function(){return this.appAst&&A()(this.appAst,{},this.appFile.content).code}}]),e}(),G=n(0),F=n(415),H=n(59),V=n(317),K=n(105),Q=n(229),U=n(11),Y=n(235),J=n(111),z=n(1379),X=n(1342),W=n(322),Z=n(1407),$=n(745),ee=n.n($),te=n(1381),ne=n.n(te),re=n(1382),ae=n.n(re),ie=n(192),se=n(1340),oe=n(1383),ce=n(3748),ue=n(1384),le=n.n(ue),pe=n(746),me=n.n(pe),de=(n(3511),function(e){function t(){return Object(y.a)(this,t),Object(j.a)(this,Object(S.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){me.a.highlightAll()}},{key:"componentDidUpdate",value:function(){me.a.highlightAll()}},{key:"render",value:function(){return o.a.createElement("pre",{style:this.props.style},o.a.createElement("code",{className:"language-javascript"},this.props.code))}}]),t}(o.a.Component)),he=function(e,t){window.analytics&&window.analytics.track(e,t)},ye=function(e,t){he("Playground Action",Object(O.a)({name:e},t))},fe=function(e){function t(e){var n;return Object(y.a)(this,t),(n=Object(j.a)(this,Object(S.a)(t).call(this,e))).state={showCode:!1},n}return Object(g.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=Object(h.a)(d.a.mark(function e(){var t,n,r,a,i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.codeSandboxSource,r=t.dependencies,e.next=3,Object(b.a)("https://codesandbox.io/api/v1/sandboxes/define?json=1",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(this.codeSandboxDefinition(n,r))});case 3:return a=e.sent,e.next=6,a.json();case 6:i=e.sent,this.setState({sandboxId:i.sandbox_id});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"codeSandboxDefinition",value:function(e,t){return{files:Object(O.a)({},"string"==typeof e?{"index.js":{content:e}}:e,{"package.json":{content:{dependencies:Object(O.a)({"react-dom":"latest"},Object(ce.a)(function(){return"latest"},t))}}}),template:"create-react-app"}}},{key:"render",value:function(){var e=this,t=this.state,n=t.redirectToDashboard,r=t.showCode,a=t.sandboxId,i=t.addingToDashboard,s=this.props,c=s.resultSet,u=s.error,p=s.codeExample,m=s.render,y=s.title,f=s.codeSandboxSource,j=s.dependencies,S=s.dashboardSource,g=s.hideActions,b=s.query,v=s.cubejsApi,_=s.chartLibrary,x=s.setChartLibrary,E=s.chartLibraries;if(n)return o.a.createElement(l.a,{to:"/dashboard"});var k=Object(oe.getParameters)(this.codeSandboxDefinition(f,j));console.log(E);var C=o.a.createElement(F.a,{onClick:function(e){return x(e.key)}},E.map(function(e){return o.a.createElement(F.a.Item,{key:e.value},e.title)})),O=E.find(function(e){return e.value===_}),P=o.a.createElement("form",{action:"https://codesandbox.io/api/v1/sandboxes/define",method:"POST",target:"_blank"},o.a.createElement("input",{type:"hidden",name:"parameters",value:k}),o.a.createElement(H.a.Group,null,S&&o.a.createElement(H.a,{onClick:Object(h.a)(d.a.mark(function t(){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return ye("Add to Dashboard"),e.setState({addingToDashboard:!0}),t.next=4,S.addChart(p);case 4:e.setState({redirectToDashboard:!0,addingToDashboard:!1});case 5:case"end":return t.stop()}},t,this)})),icon:"plus",size:"small",loading:i},i?"Creating app and installing modules...":"Add to Dashboard"),o.a.createElement(V.a,{overlay:C},o.a.createElement(H.a,{size:"small"},O&&O.title,o.a.createElement(U.a,{type:"down"}))),o.a.createElement(H.a,{onClick:function(){ye("Show Code"),e.setState({showCode:"code"===r?null:"code"})},icon:"code",size:"small",type:"code"===r?"primary":"default"},"Code"),o.a.createElement(H.a,{onClick:function(){ye("Show SQL"),e.setState({showCode:"sql"===r?null:"sql"})},icon:"question-circle",size:"small",type:"sql"===r?"primary":"default"},"SQL"),o.a.createElement(H.a,{icon:"code-sandbox",size:"small",onClick:function(){return ye("Open Code Sandbox")},htmlType:"submit"},"Edit")));return g?m({resultSet:c,error:u,sandboxId:a}):o.a.createElement(z.a,{title:y,style:{minHeight:420},extra:P},r?"code"===r?o.a.createElement(de,{code:p}):"sql"===r?o.a.createElement(W.QueryRenderer,{loadSql:"only",query:b,cubejsApi:v,render:function(e){var t=e.sqlQuery;return o.a.createElement(de,{code:t&&le.a.format(t.sql())})}}):null:m({resultSet:c,error:u,sandboxId:a}))}}]),t}(o.a.Component);fe.defaultProps={query:{},cubejsApi:null,hideActions:null,dashboardSource:null,codeSandboxSource:null,title:null,codeExample:null,error:null,resultSet:null};var je=fe,Se=n(1388),ge=n(22),be=n.n(ge),ve={line:'\n  <Chart scale={{ x: { tickCount: 8 } }} height={400} data={stackedChartData(resultSet)} forceFit>\n    <Axis name="x" />\n    <Axis name="measure" />\n    <Tooltip crosshairs={{type : \'y\'}} />\n    <Geom type="line" position={`x*measure`} size={2} color="color" />\n  </Chart>',bar:'\n  <Chart scale={{ x: { tickCount: 8 } }} height={400} data={stackedChartData(resultSet)} forceFit>\n    <Axis name="x" />\n    <Axis name="measure" />\n    <Tooltip />\n    <Geom type="intervalStack" position={`x*measure`} color="color" />\n  </Chart>',area:'\n  <Chart scale={{ x: { tickCount: 8 } }} height={400} data={stackedChartData(resultSet)} forceFit>\n    <Axis name="x" />\n    <Axis name="measure" />\n    <Tooltip crosshairs={{type : \'y\'}} />\n    <Geom type="areaStack" position={`x*measure`} size={2} color="color" />\n  </Chart>',pie:"\n  <Chart height={400} data={resultSet.chartPivot()} forceFit>\n    <Coord type='theta' radius={0.75} />\n    {resultSet.seriesNames().map(s => (<Axis name={s.key} />))}\n    <Legend position='right' />\n    <Tooltip />\n    {resultSet.seriesNames().map(s => (<Geom type=\"intervalStack\" position={s.key} color=\"category\" />))}\n  </Chart>"},_e=function(e){var t=e.chartType,n=e.renderFnName;return"import { Chart, Axis, Tooltip, Geom, Coord, Legend } from 'bizcharts';\nimport { Row, Col, Statistic, Table } from 'antd';\nimport moment from 'moment';\n\nconst stackedChartData = (resultSet) => {\n  const data = resultSet.pivot().map(\n    ({ xValues, yValuesArray }) =>\n      yValuesArray.map(([yValues, m]) => ({\n        x: resultSet.axisValuesString(xValues, ', '),\n        color: resultSet.axisValuesString(yValues, ', '),\n        measure: m && Number.parseFloat(m)\n      }))\n  ).reduce((a, b) => a.concat(b));\n\n  return data;\n}\n\nconst ".concat(n," = ({ resultSet }) => (").concat(ve[t],"\n);")},xe={bizcharts:Se,moment:be.a},Ee=n(1389),ke={line:"\n  const data = {\n    labels: resultSet.categories().map(c => c.category),\n    datasets: resultSet.series().map((s, index) => (\n      {\n        label: s.title,\n        data: s.series.map(r => r.value),\n        borderColor: COLORS_SERIES[index],\n        fill: false\n      }\n    )),\n  };\n  const options = {};\n  return <Line data={data} options={options} />;",bar:"\n  const data = {\n    labels: resultSet.categories().map(c => c.category),\n    datasets: resultSet.series().map((s, index) => (\n      {\n        label: s.title,\n        data: s.series.map(r => r.value),\n        backgroundColor: COLORS_SERIES[index],\n        fill: false\n      }\n    )),\n  };\n  const options = {\n    scales: { xAxes: [{ stacked: true }] }\n  };\n  return <Bar data={data} options={options} />;",area:"\n  const data = {\n    labels: resultSet.categories().map(c => c.category),\n    datasets: resultSet.series().map((s, index) => (\n      {\n        label: s.title,\n        data: s.series.map(r => r.value),\n        backgroundColor: COLORS_SERIES[index]\n      }\n    )),\n  };\n  const options = {\n    scales: { yAxes: [{ stacked: true }] }\n  };\n  return <Line data={data} options={options} />;",pie:"\n  const data = {\n    labels: resultSet.categories().map(c => c.category),\n    datasets: resultSet.series().map(s => (\n      {\n        label: s.title,\n        data: s.series.map(r => r.value),\n        backgroundColor: COLORS_SERIES,\n        hoverBackgroundColor: COLORS_SERIES,\n      }\n    ))\n  };\n  const options = {};\n  return <Pie data={data} options={options} />;"},Ce=function(e){var t=e.chartType,n=e.renderFnName;return"import { Line, Bar, Pie } from 'react-chartjs-2';\nimport moment from 'moment';\n\nconst COLORS_SERIES = ['#FF6492', '#141446', '#7A77FF'];\n\nconst ".concat(n," = ({ resultSet }) => {").concat(ke[t],"\n};")},Oe={"react-chartjs-2":Ee,moment:be.a},Pe={number:'\n  <Row type="flex" justify="center" align="middle" style={{ height: \'100%\' }}>\n    <Col>\n      {resultSet\n        .seriesNames()\n        .map(s => (\n          <Statistic value={resultSet.totalRow()[s.key]} />\n        ))}\n    </Col>\n  </Row>\n  ',table:"\n  <Table \n    pagination={false}\n    columns={resultSet.tableColumns().map(c => ({ ...c, dataIndex: c.key }))} \n    dataSource={resultSet.tablePivot()} \n  />\n  "},we=function(e){var t=e.chartType,n=e.renderFnName;return"import { Row, Col, Statistic, Table } from 'antd';\nimport \"antd/dist/antd.css\";\n\nconst ".concat(n," = ({ resultSet }) => (").concat(Pe[t],"\n);")},De={},Me={bizcharts:{library:r,title:"Bizcharts"},chartjs:{library:a,title:"Chart.js"}},Ae={presets:[ne.a,ae.a]},Te=function(e){var t=e.chartLibrary,n=e.query,r=e.apiUrl,a=e.cubejsToken,i=e.chartType,s="".concat(i,"Render");return"import React from 'react';\nimport cubejs from '@cubejs-client/core';\nimport { QueryRenderer } from '@cubejs-client/react';\nimport { Spin } from 'antd';\n".concat(t.sourceCodeTemplate(Object(O.a)({},e,{renderFnName:s})),'\n\nconst API_URL = "').concat(r,'"; // change to your actual endpoint\n\nconst cubejsApi = cubejs(\n  "').concat(a,'",\n  { apiUrl: API_URL + "/cubejs-api/v1" }\n);\n\nconst renderChart = (Component) => ({ resultSet, error }) => (\n  (resultSet && <Component resultSet={resultSet} />) ||\n  (error && error.toString()) || \n  (<Spin />)\n)\n\nconst ChartRenderer = () => <QueryRenderer\n  query={').concat(("object"==typeof n?JSON.stringify(n,null,2):n).split("\n").map(function(e,t){return t>0?"  ".concat(e):e}).join("\n"),"}\n  cubejsApi={cubejsApi}\n  render={renderChart(").concat(s,")}\n/>;\n\nexport default ChartRenderer;\n")},Le=function(e){return"import ReactDOM from 'react-dom';\n".concat(e,'\n\nconst rootElement = document.getElementById("root");\nReactDOM.render(<ChartRenderer />, rootElement);\n')},qe=function(e){var t=e.query,n=e.sourceCodeFn,r=e.title,a=e.resultSet,c=e.error,u=e.sqlQuery,l=e.dashboardSource,p=e.cubejsApi,m=e.chartType,d=Object(s.useState)("bizcharts"),h=Object(Z.a)(d,2),y=h[0],f=h[1];n=n||Te;var j=-1!==["table","number"].indexOf(m)?i:Me[y].library,S=n(Object(O.a)({},e,{chartLibrary:j})),g=Object(O.a)({"@cubejs-client/core":E.a,"@cubejs-client/react":W,antd:ie,react:o.a},j.imports);return o.a.createElement(ee.a,{babelConfig:Ae,onError:function(e){return console.log(e)},resolver:function(e){return g[e]},source:S},o.a.createElement(ee.a.Consumer,null,function(e){var n=e.element,i=e.error;return o.a.createElement(je,{title:r,query:t,resultSet:a,error:c,sqlQuery:u,codeExample:S,codeSandboxSource:Le(S),dependencies:g,dashboardSource:l,chartLibrary:y,setChartLibrary:f,chartLibraries:Object.keys(Me).map(function(e){return{value:e,title:Me[e].title}}),cubejsApi:p,render:function(){return i?o.a.createElement(se.a,{message:"Error occurred while compiling JS",description:o.a.createElement("pre",null,i.toString()),type:"error"}):n}})}))},Be=function(e,t){return o.a.createElement(F.a,null,t.length?t.map(function(t){return o.a.createElement(F.a.Item,{key:t.name,onClick:function(){return e(t)}},t.title)}):o.a.createElement(F.a.Item,{disabled:!0},"No members found"))},Re=function(e){var t=e.members,n=e.availableMembers,r=e.addMemberName,a=e.updateMethods;return o.a.createElement("span",null,t.map(function(e){return o.a.createElement(H.a.Group,{style:{marginRight:8},key:e.index||e.name},o.a.createElement(V.a,{overlay:Be(function(t){ye("Update Member",{memberName:r}),a.update(e,t)},n),placement:"bottomLeft",trigger:["click"]},o.a.createElement(H.a,null,e.title)),o.a.createElement(H.a,{type:"danger",icon:"close",onClick:function(){ye("Remove Member",{memberName:r}),a.remove(e)}}))}),o.a.createElement(V.a,{overlay:Be(function(e){ye("Add Member",{memberName:r}),a.add(e)},n),placement:"bottomLeft",trigger:["click"]},o.a.createElement(H.a,{type:"dashed",icon:"plus"},r)))},Ie={string:function(e){var t=e.values,n=e.onChange;return o.a.createElement(K.a,{key:"input",style:{width:300},mode:"tags",onChange:n,value:t})},number:function(e){var t=e.values,n=e.onChange;return o.a.createElement(Q.a,{key:"input",style:{width:300},onChange:function(e){return n([e.target.value])},value:t&&t[0]||""})}};Ie.string.propTypes={values:G.array,onChange:G.func.isRequired},Ie.string.defaultProps={values:[]},Ie.number.propTypes={values:G.array,onChange:G.func.isRequired},Ie.number.defaultProps={values:[]};var Ne=function(e){var t=e.member,n=e.updateMethods,r=e.addMemberName,a=Ie[t.dimension.type]||Ie.string;return o.a.createElement(a,{key:"filter",values:t.values,onChange:function(e){ye("Update Filter Values",{memberName:r}),n.update(t,Object(O.a)({},t,{values:e}))}})},Ge=function(e){var t=e.members,n=e.availableMembers,r=e.addMemberName,a=e.updateMethods;return o.a.createElement("span",null,t.map(function(e){return o.a.createElement("div",{style:{marginBottom:12},key:e.index},o.a.createElement(H.a.Group,{style:{marginRight:8}},o.a.createElement(V.a,{overlay:Be(function(t){ye("Update Member",{memberName:r}),a.update(e,Object(O.a)({},e,{dimension:t}))},n),placement:"bottomLeft",trigger:["click"]},o.a.createElement(H.a,{style:{width:150,textOverflow:"ellipsis",overflow:"hidden"}},e.dimension.title)),o.a.createElement(H.a,{type:"danger",icon:"close",onClick:function(){ye("Remove Member",{memberName:r}),a.remove(e)}})),o.a.createElement(K.a,{value:e.operator,onChange:function(t){return a.update(e,Object(O.a)({},e,{operator:t}))},style:{width:200,marginRight:8}},e.operators.map(function(e){return o.a.createElement(K.a.Option,{key:e.name,value:e.name},e.title)})),o.a.createElement(Ne,{member:e,key:"filterInput",updateMethods:a,addMemberName:r}))}),o.a.createElement(V.a,{overlay:Be(function(e){ye("Add Member",{memberName:r}),a.add({dimension:e})},n),placement:"bottomLeft",trigger:["click"]},o.a.createElement(H.a,{type:"dashed",icon:"plus"},r)))},Fe=function(e){var t=e.members,n=e.availableMembers,r=e.addMemberName,a=e.updateMethods,i=new Date;i.setDate(i.getDate()-31);var s=new Date;s.setDate(s.getDate()-1);var c=[{title:"All time",value:void 0},{value:"Today"},{value:"Yesterday"},{value:"This week"},{value:"This month"},{value:"This quarter"},{value:"This year"},{value:"Last 7 days"},{value:"Last 30 days"},{value:"Last week"},{value:"Last month"},{value:"Last quarter"},{value:"Last year"}];return o.a.createElement("span",null,t.map(function(e){return[o.a.createElement(H.a.Group,{style:{marginRight:8}},o.a.createElement(V.a,{overlay:Be(function(t){ye("Update Member",{memberName:r}),a.update(e,Object(O.a)({},e,{dimension:t}))},n),placement:"bottomLeft",trigger:["click"]},o.a.createElement(H.a,null,e.dimension.title)),o.a.createElement(H.a,{type:"danger",icon:"close",onClick:function(){ye("Remove Member",{memberName:r}),a.remove(e)}})),o.a.createElement("b",null,"FOR"),o.a.createElement(V.a,{overlay:(s=function(t){ye("Update Date Range",{memberName:r}),a.update(e,Object(O.a)({},e,{dateRange:t.value}))},o.a.createElement(F.a,null,c.map(function(e){return o.a.createElement(F.a.Item,{key:e.title||e.value,onClick:function(){return s(e)}},e.title||e.value)}))),placement:"bottomLeft",trigger:["click"]},o.a.createElement(H.a,{style:{marginLeft:8,marginRight:8}},e.dateRange||"All time")),o.a.createElement("b",null,"BY"),o.a.createElement(V.a,{overlay:(t=e.dimension,i=function(t){ye("Update Granularity",{memberName:r}),a.update(e,Object(O.a)({},e,{granularity:t.name}))},o.a.createElement(F.a,null,t.granularities.length?t.granularities.map(function(e){return o.a.createElement(F.a.Item,{key:e.name,onClick:function(){return i(e)}},e.title)}):o.a.createElement(F.a.Item,{disabled:!0},"No members found"))),placement:"bottomLeft",trigger:["click"]},o.a.createElement(H.a,{style:{marginLeft:8}},e.dimension.granularities.find(function(t){return t.name===e.granularity})&&e.dimension.granularities.find(function(t){return t.name===e.granularity}).title))];var t,i,s}),!t.length&&o.a.createElement(V.a,{overlay:Be(function(e){ye("Add Member",{memberName:r}),a.add({dimension:e,granularity:"day"})},n),placement:"bottomLeft",trigger:["click"]},o.a.createElement(H.a,{type:"dashed",icon:"plus"},r)))},He=function(e){var t=e.chartType,n=e.updateChartType,r=[{name:"line",title:"Line",icon:"line-chart"},{name:"area",title:"Area",icon:"area-chart"},{name:"bar",title:"Bar",icon:"bar-chart"},{name:"pie",title:"Pie",icon:"pie-chart"},{name:"table",title:"Table",icon:"table"},{name:"number",title:"Number",icon:"info-circle"}],a=o.a.createElement(F.a,null,r.map(function(e){return o.a.createElement(F.a.Item,{key:e.title,onClick:function(){ye("Change Chart Type"),n(e.name)}},o.a.createElement(U.a,{type:e.icon}),e.title)})),i=r.find(function(e){return e.name===t});return o.a.createElement(V.a,{overlay:a,placement:"bottomLeft",trigger:["click"]},o.a.createElement(H.a,{icon:i.icon},i.title))},Ve=function(e){var t=e.query,n=e.cubejsApi,r=e.apiUrl,a=e.cubejsToken,i=e.dashboardSource;return o.a.createElement(W.QueryBuilder,{query:t,cubejsApi:n,render:function(e){var t=e.resultSet,s=e.error,c=e.validatedQuery,u=e.isQueryPresent,l=e.chartType,p=e.updateChartType,m=e.measures,d=e.availableMeasures,h=e.updateMeasures,y=e.dimensions,f=e.availableDimensions,j=e.updateDimensions,S=e.segments,g=e.availableSegments,b=e.updateSegments,v=e.filters,_=e.updateFilters,x=e.timeDimensions,E=e.availableTimeDimensions,k=e.updateTimeDimensions;return[o.a.createElement(Y.a,{type:"flex",justify:"space-around",align:"top",gutter:24,style:{marginBottom:12},key:"1"},o.a.createElement(J.a,{span:24},o.a.createElement(z.a,null,o.a.createElement(Y.a,{type:"flex",justify:"space-around",align:"top",gutter:24,style:{marginBottom:12}},o.a.createElement(J.a,{span:24},o.a.createElement(Re,{members:m,availableMembers:d,addMemberName:"Measure",updateMethods:h}),o.a.createElement(X.a,{type:"vertical"}),o.a.createElement(Re,{members:y,availableMembers:f,addMemberName:"Dimension",updateMethods:j}),o.a.createElement(X.a,{type:"vertical"}),o.a.createElement(Re,{members:S,availableMembers:g,addMemberName:"Segment",updateMethods:b}),o.a.createElement(X.a,{type:"vertical"}),o.a.createElement(Fe,{members:x,availableMembers:E,addMemberName:"Time",updateMethods:k}))),o.a.createElement(Y.a,{type:"flex",justify:"space-around",align:"top",gutter:24,style:{marginBottom:12}},o.a.createElement(J.a,{span:24},o.a.createElement(Ge,{members:v,availableMembers:f.concat(d),addMemberName:"Filter",updateMethods:_}))),o.a.createElement(Y.a,{type:"flex",justify:"space-around",align:"top",gutter:24},o.a.createElement(J.a,{span:24},o.a.createElement(He,{chartType:l,updateChartType:p})))))),o.a.createElement(Y.a,{type:"flex",justify:"space-around",align:"top",gutter:24,key:"2"},o.a.createElement(J.a,{span:24},u?o.a.createElement(qe,{query:c,resultSet:t,error:s,title:"Chart",apiUrl:r,cubejsToken:a,chartType:l,cubejsApi:n,dashboardSource:i}):o.a.createElement("h2",{style:{textAlign:"center"}},"Choose a measure or dimension to get started")))]}})};Ve.defaultProps={query:{},cubejsApi:null,dashboardSource:null,apiUrl:"/cubejs-api/v1",cubejsToken:null};var Ke=Ve,Qe=function(e){function t(e){var n;return Object(y.a)(this,t),(n=Object(j.a)(this,Object(S.a)(t).call(this,e))).state={},n.dashboardSource=new N,n}return Object(g.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=Object(h.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.a)("/playground/context");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,this.setState({cubejsToken:n.cubejsToken,apiUrl:n.apiUrl||window.location.href.split("#")[0].replace(/\/$/,"")});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"cubejsApi",value:function(){var e=this.state,t=e.cubejsToken,n=e.apiUrl;return!this.cubejsApiInstance&&t&&(this.cubejsApiInstance=E()(t,{apiUrl:"".concat(n,"/cubejs-api/v1")})),this.cubejsApiInstance}},{key:"render",value:function(){var e=this.state,t=e.cubejsToken,n=e.apiUrl;return this.cubejsApi()&&o.a.createElement(Ke,{query:{},cubejsApi:this.cubejsApi(),apiUrl:n,cubejsToken:t,dashboardSource:this.dashboardSource})||null}}]),t}(s.Component),Ue=n(1378),Ye=n(1377),Je=n(413),ze=n(1376),Xe=Ue.a.Content,We=Ue.a.Sider,Ze=Ye.a.TreeNode,$e=Je.a.TabPane,et=function(e){function t(e){var n;return Object(y.a)(this,t),(n=Object(j.a)(this,Object(S.a)(t).call(this,e))).state={expandedKeys:[],autoExpandParent:!0,checkedKeys:[],selectedKeys:[],activeTab:"schema",files:[]},n}return Object(g.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=Object(h.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadDBSchema();case 2:return e.next=4,this.loadFiles();case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onExpand",value:function(e){ye("Expand Tables"),this.setState({expandedKeys:e,autoExpandParent:!1})}},{key:"onCheck",value:function(e){ye("Check Tables"),this.setState({checkedKeys:e})}},{key:"onSelect",value:function(e){this.setState({selectedKeys:e})}},{key:"cubejsApi",value:function(){var e=this.state,t=e.cubejsToken,n=e.apiUrl;return!this.cubejsApiInstance&&t&&(this.cubejsApiInstance=E()(t,{apiUrl:"".concat(n,"/cubejs-api/v1")})),this.cubejsApiInstance}},{key:"loadDBSchema",value:function(){var e=Object(h.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({schemaLoading:!0}),e.prev=1,e.next=4,q("/playground/db-schema");case 4:return t=e.sent,e.next=7,t.json();case 7:n=e.sent,this.setState({tablesSchema:n.tablesSchema}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),this.setState({schemaLoadingError:e.t0});case 14:return e.prev=14,this.setState({schemaLoading:!1}),e.finish(14);case 17:case"end":return e.stop()}},e,this,[[1,11,14,17]])}));return function(){return e.apply(this,arguments)}}()},{key:"loadFiles",value:function(){var e=Object(h.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q("/playground/files");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,this.setState({files:n.files});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"generateSchema",value:function(){var e=Object(h.a)(d.a.mark(function e(){var t,n,r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.checkedKeys,n=this.props.history,ye("Generate Schema"),e.next=5,q("/playground/generate-schema",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tables:t.filter(function(e){return 2===e.split(".").length})})});case 5:if(200!==(r=e.sent).status){e.next=14;break}return ye("Generate Schema Success"),e.next=10,this.loadFiles();case 10:this.setState({checkedKeys:[],activeTab:"files"}),ze.a.success({title:"Schema files successfully generated!",content:"You can start building the charts",okText:"Explore",cancelText:"Close",okCancel:!0,onOk:function(){n.push("/explore")}}),e.next=20;break;case 14:return e.t0=ye,e.next=17,r.text();case 17:e.t1=e.sent,e.t2={error:e.t1},(0,e.t0)("Generate Schema Fail",e.t2);case 20:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"selectedFileContent",value:function(){var e=this.state,t=e.files,n=e.selectedFile,r=t.find(function(e){return e.fileName===n});return r&&r.content}},{key:"renderFilesMenu",value:function(){var e=this,t=this.state,n=t.selectedFile,r=t.files;return o.a.createElement(F.a,{mode:"inline",onClick:function(t){var n=t.key;ye("Select File"),e.setState({selectedFile:n})},selectedKeys:n?[n]:[]},r.map(function(e){return o.a.createElement(F.a.Item,{key:e.fileName},e.fileName)}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.schemaLoading,r=t.schemaLoadingError,a=t.tablesSchema,i=t.selectedFile,s=t.expandedKeys,c=t.autoExpandParent,u=t.checkedKeys,l=t.selectedKeys,p=t.activeTab,m=o.a.createElement(F.a,null,o.a.createElement(F.a.Item,{onClick:function(){return e.generateSchema()}},"Generate Schema")),d=function(){return Object.keys(a||{}).length>0?o.a.createElement(Ye.a,{checkable:!0,onExpand:e.onExpand.bind(e),expandedKeys:s,autoExpandParent:c,onCheck:e.onCheck.bind(e),checkedKeys:u,onSelect:e.onSelect.bind(e),selectedKeys:l},function e(t){return t.map(function(t){return t.children?o.a.createElement(Ze,{title:t.title,key:t.key,dataRef:t},e(t.children)):o.a.createElement(Ze,t)})}((t=a||{},Object.keys(t).map(function(e){return{title:e,key:e,children:Object.keys(t[e]).map(function(t){return{title:t,key:"".concat(e,".").concat(t)}})}})))):o.a.createElement(se.a,{message:"Empty DB Schema",description:"Please check connection settings",type:"warning"});var t};return o.a.createElement(Ue.a,{style:{height:"100%"}},o.a.createElement(We,{width:300,style:{background:"#fff"},className:"schema-sidebar"},o.a.createElement(Je.a,{activeKey:p,onChange:function(t){return e.setState({activeTab:t})},tabBarExtraContent:o.a.createElement(V.a,{overlay:m,placement:"bottomRight",disabled:!u.length},o.a.createElement(H.a,{shape:"circle",icon:"plus",type:"primary",style:{marginRight:8}}))},o.a.createElement($e,{tab:"Tables",key:"schema"},n?o.a.createElement(v.a,{style:{width:"100%"}}):r?o.a.createElement(se.a,{message:"Error while loading DB schema",description:r.toString(),type:"error"}):d()),o.a.createElement($e,{tab:"Files",key:"files"},this.renderFilesMenu()))),o.a.createElement(Xe,{style:{minHeight:280}},i?o.a.createElement(de,{code:this.selectedFileContent(),style:{padding:12}}):o.a.createElement("h2",{style:{padding:24,textAlign:"center"}},"Select tables to generate Cube.js schema")))}}]),t}(s.Component),tt=function(e){function t(e){var n;return Object(y.a)(this,t),(n=Object(j.a)(this,Object(S.a)(t).call(this,e))).state={},n}return Object(g.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=Object(h.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.dashboardSource=new N,e.next=3,this.loadDashboard();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"loadDashboard",value:function(){var e=Object(h.a)(d.a.mark(function e(t){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({appCode:null,loadError:null}),e.next=3,this.dashboardSource.load(t);case 3:return this.setState({dashboardStarting:!1,appCode:!this.dashboardSource.loadError&&this.dashboardSource.dashboardAppCode(),loadError:this.dashboardSource.loadError}),e.next=6,q("/playground/dashboard-app-status");case 6:return e.next=8,e.sent.json();case 8:n=e.sent,this.setState({dashboardRunning:n.running,dashboardPort:n.dashboardPort});case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"startDashboardApp",value:function(){var e=Object(h.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({dashboardStarting:!0}),e.next=3,q("/playground/start-dashboard-app");case 3:return e.next=5,this.loadDashboard();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,n=t.appCode,r=t.dashboardPort,a=t.loadError,i=t.dashboardRunning,s=t.dashboardStarting;return a?o.a.createElement("div",{style:{textAlign:"center"}},o.a.createElement("h2",null,a),o.a.createElement("p",{style:{textAlign:"center"}},o.a.createElement(H.a,{type:"primary",size:"large",onClick:function(){return e.loadDashboard(!0)}},"Create dashboard app template in your project directory"))):n?i?o.a.createElement("iframe",{src:"http://".concat(window.location.hostname,":").concat(r),style:{width:"100%",height:"100%",border:0,borderRadius:4,overflow:"hidden"},sandbox:"allow-modals allow-forms allow-popups allow-scripts allow-same-origin",title:"Dashboard"}):o.a.createElement("div",{style:{textAlign:"center"}},o.a.createElement("h2",null,"Dashboard App is not running.",o.a.createElement("br",null),"Please start dashboard app or run it manually using `$ npm run start` in dashboard-app directory."),o.a.createElement("p",{style:{textAlign:"center"}},o.a.createElement(H.a,{type:"primary",size:"large",loading:s,onClick:function(){return e.startDashboardApp(!0)}},"Start dashboard app"))):o.a.createElement("h2",{style:{textAlign:"center"}},o.a.createElement(v.a,null),"Â Creating dashboard react-app. It may take several minutes...")}}]),t}(s.Component),nt=n(279),rt=(n(3739),n(3740),n(1345)),at=Ue.a.Header,it=Ue.a.Content,st=function(e){function t(){return Object(y.a)(this,t),Object(j.a)(this,Object(S.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=Object(h.a)(d.a.mark(function e(){var t,n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return window.addEventListener("unhandledrejection",function(e){var t=e.reason;console.log(t);var n=(t.stack||t).toString();he("Playground Error",{error:n}),rt.a.error({message:o.a.createElement("span",null,o.a.createElement("b",null,"Error"),"Â ðŸ˜¢",o.a.createElement("div",null,"Ask about it inÂ ",o.a.createElement("a",{href:"https://cubejs-community.herokuapp.com",target:"_blank",rel:"noopener noreferrer"},"Slack"),". These guys know how to fix this for sure!")),description:n})}),e.next=3,Object(b.a)("/playground/context");case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,window.analytics&&window.analytics.identify(n.anonymousId,{coreServerVersion:n.coreServerVersion});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidCatch",value:function(e,t){he("Playground Error",{error:(e.stack||e).toString(),info:t.toString()})}},{key:"render",value:function(){var e=(this.state||{}).fatalError,t=this.props,n=t.location,r=t.children;return o.a.createElement(Ue.a,{style:{height:"100%"}},o.a.createElement(at,{style:{padding:"0 32px"}},o.a.createElement("div",{style:{float:"left"}},o.a.createElement("img",{src:"./cubejs-logo.svg",style:{display:"inline",width:50},alt:""})),o.a.createElement(F.a,{theme:"dark",mode:"horizontal",selectedKeys:[n.pathname],style:{lineHeight:"64px"}},o.a.createElement(F.a.Item,{key:"/explore"},o.a.createElement(nt.a,{to:"/explore"},"Explore")),o.a.createElement(F.a.Item,{key:"/dashboard"},o.a.createElement(nt.a,{to:"/dashboard"},"Dashboard")),o.a.createElement(F.a.Item,{key:"/schema"},o.a.createElement(nt.a,{to:"/schema"},"Schema")))),o.a.createElement(it,{style:{height:"100%"}},e?o.a.createElement(se.a,{message:"Error occured while rendering",description:e.stack,type:"error"}):r))}}],[{key:"getDerivedStateFromError",value:function(e){return{fatalError:e}}}]),t}(s.Component);st.defaultProps={children:[]};var ot=Object(l.e)(st),ct=Object(p.b)();ct.listen(function(e){var t;t=e,window.analytics&&window.analytics.page(t)}),u.a.render(o.a.createElement(l.c,{history:ct},o.a.createElement(ot,null,o.a.createElement(l.b,{key:"index",exact:!0,path:"/",component:_}),o.a.createElement(l.b,{key:"explore",path:"/explore",component:Qe}),o.a.createElement(l.b,{key:"schema",path:"/schema",component:et}),o.a.createElement(l.b,{key:"dashboard",path:"/dashboard",component:tt}))),document.getElementById("root"))}});